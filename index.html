<!DOCTYPE html>
<html>
	<head>
		<title>White Sands</title>
		<meta charset="utf-8" />
		<script src="main.js"></script>
		<script>
			/* global page, particle, event, collision */
			window.onload = function(){
				//debugger;
				page.canvas = document.getElementById("canvas");
				page.dPanel = document.getElementById("dPanel");

				window.requestAnimationFrame = (function(){
					//Check for each browser
					//@paul_irish function
					//Globalises this function to work on any browser as each browser has a different namespace for this
					return  window.requestAnimationFrame       ||  //Chromium
							window.webkitRequestAnimationFrame ||  //Webkit
							window.mozRequestAnimationFrame    || //Mozilla Geko
							window.oRequestAnimationFrame      || //Opera Presto
							window.msRequestAnimationFrame     || //IE Trident?
							function(callback, element){ //Fallback function
								window.setTimeout(callback, 1000/60);
							};
				})();

				//Game objects
				var game = page.game;
				game.ball = new particle(10, 10);
				game.ball.setPos(100, 50);
				game.ball.setVel(0.1, 0.1);
				game.dragon = new particle(20, 20);
				game.dragon.setPos(300, 100);

				//Add some events so something actually happens in the "event-based" game.
				var myEvent = new event(1000, collision, "", "initialize collisions", false);
				var myEvent2 = new event(20000, function(){game.ball.setPos(250, 250);}, "How you like this?", "teleport", false);
				var myEvent3 = new event(30000, function(){game.ball.setPos(300, 200); collision();}, "Haha, gotcha!", "teleport again", false);
				var myEvent4 = new event(180000, function(){game.ball.setPos(50, 50);}, "", "You must be REALLY bored...", false);
				var myEvent5 = new event(3600000, function(){game.ball.setPos(300,200);}, "", "LOL, seriously?!  No more.", false);

				game.timeLine.push(myEvent);
				game.timeLine.push(myEvent2);
				game.timeLine.push(myEvent3);
				game.timeLine.push(myEvent4);
				game.timeLine.push(myEvent5);

				nextFrame();

			}
		</script>

	</head>
	<body>
		<canvas id="canvas" width="600" height="400" style="border: 1px solid black; left: 0; top: 0;" }  >Your browser does not support Canvas.</canvas>
		<canvas id="dPanel" width="170" height="400" style="border: 1px solid black; left: 600; top: 0;" }  >Your browser does not support Canvas.</canvas>
		<form name="htmlcontrols">
			<input type="checkbox" name="pause" onclick="togglePause()"/> Pause
			<input type="checkbox" name="cleanblit" onclick="toggleCleanBlit()" checked/> Clean blitting
		</form>
	</body>
</html>